# Тестовое задание на вакансию аналитика данных компании "Юнона"
___
### Инструменты:

*Microsoft Excel, Google Sheets, SQL(PostgreSQL), регулярные выражения(RegEx)*
___
### Описание проекта

В качестве тестового задания на вакансию аналитика данных для компании "Юнона" был предоставлен Excel-документ с тремя наборами задач для решения - два набора задач на уровень работы с электронными таблицами и один на работу с языком SQL и реляционными базами данных. Задания содержатся в Excel-документе на отдельных листах и могут быть переформулированы следующим образом:

1. Написать два макроса, которые вытаскивают необходимые значения из Таблиц Количество и Цена, проводят вычисления и заносят результаты в Таблицы 1 и 2.

2. Из электронной таблицы с данными платежей на 20 тыс. строк вынести ФИО плательщика/должника, номер постановления и дату постановления в отдельные столбцы. 

3. Написать четыре SQL-запроса разной сложности к двум таблицам базы данных.


Дублирую ссылки на решенные задачи:

Документ с заданиями: https://docs.google.com/spreadsheets/d/1Mqb9AspFrMUEM3TNvUqkx-NBul0lEddbJzlz-WFJurA/edit?usp=sharing

SQL-запросы: https://disk.yandex.ru/d/wJR4OSJi5KZckQ


### Комментарии к проекту:

Так как функциональность Microsoft Excel и Google Sheets для решения предоставленных задач можно считать равнозначной, а для написания SQL-запросов не был указан предпочтимый диалект языка SQL, для выполнения тестового задания были выбраны Google Sheets и диалект PostgreSQL как более доступные альтернативы. 

1. [**Задание 1**]

Макросы были успешно написаны, используя всего одну функцию в обеих конструкциях: SUMIFS(). Для первого макроса (подсчитать общее количество каждого проданного товара) идея следующая - мы складываем количество проданного товара по наименованию в таблице Количество и добавляем значение напротив того же наименования товара в таблице 1.

Идея второго макроса выглядит следующим образом - мы суммируем количество проданных товаров для каждого клиента по каждой категории отдельно из таблицы Количество, умножаем на цену товара из таблицы Цена и делим на тысячу, чтобы получить значение в тыс. руб. по каждому клиенту. 


2. [**Задание 2**]

Так как вычленить необходимые параметры из данных постановлений удовлетворительно, используя только внутренний функционал Microsoft Excel или Google Sheets не представлялось возможным, для решения задания 2 использовал регулярные выражения для всех трех столбцов. Решение задачи данным образом дало хороший результат: пропущенные значения были обнаружены только для постановлений, где отсутствовали дата или номер постановления, а сама конструкция регулярных выражений может быть использована вне Excel/Sheets для выделения параметров из схожих постановлений в таблицах большего обьема.

3. [**Задание 3**]

1. Для того, чтобы вывести список сотрудников, получающих заработную плату больше чем у начальника их отдела, джоиним таблицу сотрудников саму на себя по идентификатору начальников, чтобы получить колонку с зарплатой начальника у каждого подчиненного, и внутри джоина оставил только сотрудников, у которых зарплата больше их начальника - и в итоге вывел их идентификаторы. 

2. Чтобы вывести список сотрудников, получающих максимальную заработную плату в каждом отделе, сначала внутри CTE мы находим максимальную зарплату для каждого отдела, а в основном запросе мы джоиним таблицу сотрудников и CTE с максимальной зарплатой по отделам - и выводим идентификаторы сотрудников, у которых зарплата равна максимальной зарплате по отделу в CTE.

3. Чтобы вывести список идентификаторов отделов, количество сотрудников которых не превышает трех человек, мы группируем таблицу по идентификаторам отделов и оставляем только отделы, где число идентификаторов сотрудников больше или равно трем - а затем выводим идентификатор отдела и число сотрудников.

4. Чтобы вывести список опоздавших сотрудников с учетом разницы в часовых поясах, создаем CTE с разницей во времени для каждого сотрудника, создаем CTE с временем начала работы и запуска ПО в соответствии с часовым поясом сотрудника - а в основном запросе выводим ФИО, время запуска ПО и на сколько часов опоздал сотрудник из второй CTE для всех сотрудников, которые опоздали более чем на час. Запрос не учитывает опоздания менее чем на час, потому что я не монстр. 
___
